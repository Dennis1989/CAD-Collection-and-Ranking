# DB Schema

## Mephisto

The state needed to run the game and needs to be sent to the frontend.
This corresponds to `agent_state` and if so is stored in the
mephisto DB.

```
game_phase: ENUM(cad, ranking)
cad:
    original: STRING
    generated: STRING | NULL
ranking:
    input: ARRAY(STRING)
    ranked: ARRAY(STRING) | NULL
```

## Our DB

The data that we save to our database:

Sentences Collection:

```
_id: MongoDB ID
sentence: STRING
```

Games Collection:

```
_id: MongoDB ID
counterexample: STRING
id_original: Ref(Sentences)
worker_id: MephistoDB ID
```

Rankings Collection:

```
_id: MongoDB ID
sentences: ARRAY(Ref(Counterexamples))
worker_id: MephistoDB ID
score: ARRAY(Ref(Counterexamples))
```

The above schema describes the structure of three collections in a MongoDB database: Sentences, Counterexamples, and Rankings.

#### Sentences Collection:

This collection represents a set of sentences.
Each document in the Sentences collection has the following fields:
* _id: A unique identifier generated by MongoDB for each document in the collection.
* sentence: A field of type String that stores the actual sentence data.

#### Counterexamples Collection:

This collection stores counterexamples related to the sentences from the Sentences collection.
Each document in the Counterexamples collection has the following fields:

* _id: A unique identifier generated by MongoDB for each document in the collection.
* counterexample: A field of type String that holds the counterexample data.
* id_original: A reference field (Ref) that refers to the original sentence from the Sentences collection. It stores the _id value of the corresponding sentence document.
* worker_id: A field of type ObjectId that represents the workers ID associated with the counterexample.

#### Rankings Collection:

This collection represents rankings or scores associated with a group of counterexamples.
Each document in the Rankings collection has the following fields:
* _id: A unique identifier generated by MongoDB for each document in the collection.
* sentences: An array field that stores references (Refs) to multiple counterexamples from the Counterexamples collection. It holds an array of _id values of the counterexample documents.
* worker_id: A field of type ObjectId that represents the MephistoDB ID associated with the ranking.
* score: An array field that stores references (Refs) to the counterexamples from the Counterexamples collection. It holds an array of _id values of the counterexample documents, representing the scores associated with each counterexample.

### ERM of the CAD_Mephisto
![CAD_ERM drawio](https://github.com/HarryGoatleaf/mephisto_ranking_task/assets/25837077/41fc1926-22c4-4d96-a4d2-6d86c843ccc8)





